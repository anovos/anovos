#input_dataset: ETL configurations of main dataset.
#input_dataset can be renamed but need to change the name in main script as well
#keys of input_dataset are function names (cannot be renamed) & values are function arguments (value can be null to skip except for read_dataset)
#delete_column/select_column: arguments can be in front or under as list_of_cols
#list_of_cols: list or string with multiple columns separated by | (refer doc string for further details)
input_dataset:
  read_dataset:
    file_path: "data/income_dataset/csv"
    file_type: csv
    file_configs:
      header: True
      delimiter: ","
      inferSchema: True
  delete_column: ['logfnl']
  select_column: null
  rename_column:
    list_of_cols: ['marital-status','education-num']
    list_of_newcols: ['marital_status','education_num']
  recast_column:
    list_of_cols: ['age','education-num']
    list_of_dtypes: ['float','float']

concatenate_dataset:
  method: name
  dataset1:
    read_dataset:
      file_path: "data/income_dataset/parquet"
      file_type: parquet
    delete_column: ['logfnl']
    select_column: null
    rename_column:
      list_of_cols: ['marital-status','education-num']
      list_of_newcols: ['marital_status','education_num']
    recast_column:
      list_of_cols: ['age','education-num']
      list_of_dtypes: ['float','float']

  dataset2:
    read_dataset:
      file_path: "data/income_dataset/parquet"
      file_type: parquet
    delete_column: ['logfnl']
    select_column: null
    rename_column:
      list_of_cols: ['marital-status','education-num']
      list_of_newcols: ['marital_status','education_num']
    recast_column:
      list_of_cols: ['age','education-num']
      list_of_dtypes: ['float','float']

join_dataset:
  join_cols: ifa
  join_type: inner
  dataset1:
    read_dataset:
      file_path: "data/income_dataset/join"
      file_type: avro
    delete_column: null
    select_column: null
    rename_column:
      list_of_cols: "age|workclass"
      list_of_newcols: "dupl_age|dupl_workclass"
    recast_column: null

write_intermediate:
  file_path: "intermediate_data"
  file_type: csv
  file_configs:
    mode: overwrite
    header: True
    delimiter: ","
    inferSchema: True

write_main:
  file_path: "output"
  file_type: parquet
  file_configs:
    mode: overwrite

write_stats:
  file_path: "stats"
  file_type: parquet
  file_configs:
    mode: overwrite
